<h1>Swaparoo</h1>

<div *ngIf="!swaparooCoreAddress">
    <form [formGroup]="form" (ngSubmit)="submit()">
        <fieldset style="display: inline-block">
            <legend style="font-weight: bold;">Connect SwaparooCore</legend>

            <label for="swaparoo_core_address">SwaparooCore Address:</label> <br>
            <input type="text" name="swaparoo_core_address" formControlName="swaparoo_core_address" id="swaparoo_core_address" style="width: 20rem;">
            <button type="submit">Connect</button>
        </fieldset>
    </form>
</div>

<div *ngIf="swaparooCoreAddress" >
    <p>Connected SwaparooCore</p>
    <p>{{swaparooCoreState?.address}}</p>

    <hr>

    <h3>Users ({{usersState?.users?.length}}):</h3>
    <form [formGroup]="addUserForm" (ngSubmit)="addUser()">
        <fieldset style="display: inline-block">
            <legend style="font-weight: bold">Add User</legend>

            <label for="user_address">Address:</label> <br>
            <input type="text" name="user_address" formControlName="user_address" id="user_address" style="width: 20rem;">
            <button type="submit">Add</button>
        </fieldset>
    </form>

    <div *ngFor="let user of usersState?.users">
        <br>
        <div>
            <span *ngIf="user.address==selectedUser?.address">☑</span>
            <span *ngIf="user.address!=selectedUser?.address">☐</span>
            <button (click)="selectUser(user)" [disabled]="user.address==selectedUser?.address">select</button>
            {{user.address}}
            <span *ngIf="user.isOwner===true">(Owner)</span>
        </div>
    </div>

    <hr>

    <h3>User Balance</h3>
    <p>Ether: {{selectedUser?.ether}}</p>
    <p>Tokens:</p>
    <ul *ngFor="let tokenBalance of selectedUser?.tokenBalances">
        <li>{{tokenBalance.address}}: {{tokenBalance.amount}}</li>
    </ul>

    <hr>

    <h3>Pools ({{swaparooPoolsState?.pools?.length}}):</h3>
    <div *ngIf="selectedUser?.isOwner===true">
        <form [formGroup]="addPoolForm" (ngSubmit)="addPool()">
            <fieldset style="display: inline-block">
                <legend style="font-weight: bold">Add Pool</legend>
    
                <label for="addressTokenA">Address Token A:</label> <br>
                <input type="text" name="addressTokenA" formControlName="addressTokenA" id="addressTokenA" style="width: 20rem;">
                <br>
                <br>

                <label for="addressTokenB">Address Token B:</label> <br>
                <input type="text" name="addressTokenB" formControlName="addressTokenB" id="addressTokenB" style="width: 20rem;">
                <br>
                <br>

                <button type="submit">Add</button>
            </fieldset>
        </form>
    </div>
    <div *ngFor="let pool of swaparooPoolsState?.pools">
        <app-pool-item [pool]="pool" [selectedUser]="selectedUser"></app-pool-item>
    </div>
</div>    

